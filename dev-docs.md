# 文件批量重命名工具 — 开发文档

## 1. 项目概述

**项目名称（暂定）：** Tiny Namer
**技术栈：**  
- 前端：Vue 3 + Naive UI  
- 桌面壳：Wails（Go）  
- 后端：Go（用于调用文件系统 API 执行实际重命名）

**项目目标：**  
为普通用户提供一个**可视化、易用、功能全面**的文件批量重命名工具。通过多种命名方式（正则、替换、插入、序号、模板等）实现对本地文件的批量重命名，并提供清晰的预览与安全确认机制。

---

## 2. 核心功能

### 2.1 文件导入模块
- 支持 **选择文件**（多选文件）
- 支持 **选择文件夹**
  - 可选项：`包含子文件夹`（递归读取）
- 载入后：
  - 展示文件名、原始路径
  - 默认不立即生成新文件名，等待配置
- 可选操作：
  - 移除单个文件
  - 清空文件列表

**注意事项：**
- 选择文件夹时只读取文件，是否包含子目录文件由设置项控制
- 未来可扩展为也能重命名文件夹本身（非当前版本重点）

---

### 2.2 重命名模式模块
每种模式在配置区展示不同的表单项，并在用户更改配置后实时生成**预览文件名**。

---

## 3. 重命名模式设计

### 3.1 正则表达式模式
- **配置项**
  - 匹配规则（正则）
  - 替换规则（字符串）
  - 多选设置：
    - 忽略扩展名
    - 忽略大小写
    - 全局匹配
- **说明**：
  - 直接基于 `RegExp` 进行替换
  - 忽略扩展名时，仅匹配文件名部分

---

### 3.2 文本替换模式
- **配置项**
  - 匹配文本（字符串）
  - 替换文本（字符串）
  - 多选设置：
    - 忽略扩展名
    - 忽略大小写
- **说明**：
  - 本质使用 `string.replaceAll` 实现
  - 不支持正则字符（对普通用户更友好）

---

### 3.3 插入文本模式
- **配置项**
  - 插入文本
  - 插入位置（单选）：
    - 文件名前
    - 文件名后
    - 指定位置后（需提供索引）
    - 指定文本后（需提供文本）
  - 多选设置：
    - 忽略扩展名
- **说明**：
  - 在指定位置插入字符串
  - 索引基于字符位置，起始为 0

---

### 3.4 英文大小写转换模式
- **配置项**
  - 转换方式（单选）：
    - 全部大写
    - 全部小写
    - 首字母大写
    - 大小写反转
  - 多选设置：
    - 忽略扩展名
- **说明**：
  - 仅作用于字母字符
  - 首字母大写：仅在文件名首字符为英文时有效

---

### 3.5 添加序号模式
- **配置项**
  - 模板（可选列表或手动输入）：
    - `#{filename}` / `#-{filename}` / `#_{filename}`
  - 起始序号（数值）
  - 序号增量（数值）
  - 补零位数（数值，0 表示不补）
- **说明**：
  - 用序号批量命名，序号随文件顺序增长

---

### 3.6 扩展名模式
- **配置项**
  - 修改方式：
    - 手动输入新扩展名
    - 统一转换：
      - 转为大写
      - 转为小写
- **说明**：
  - 只操作扩展名部分
  - 如果输入新扩展名时不带`.`，自动补全

---

### 3.7 移除字符模式
- **配置项**
  - 选择要移除的字符类型（多选）：
    - 小写字母
    - 大写字母
    - 数字
    - 中文汉字（繁简体）
    - 特殊符号（!?@#$%^&~_+-=）
    - 自定义（输入框）
  - 多选设置：
    - 忽略扩展名
- **说明**：
  - 多种类型叠加移除

---

## 4. 其他功能模块

### 4.1 预览与确认
- 每次配置项变更后实时更新预览列
- 支持点击按钮「重新生成预览」
- 点击「开始重命名」前二次确认弹窗

### 4.2 排序与文件顺序调整
- 支持手动拖拽排序（影响序号模式命名顺序）
- 支持表格按文件名/路径排序

### 4.3 重命名执行逻辑
- 由前端传给 Wails 后端：
  - 文件绝对路径
  - 新文件名
- 后端执行：
  - 检查文件是否存在
  - 检查目标是否重名
  - 执行 `os.Rename`（Go）
- 返回成功/失败状态给前端

---

## 5. 数据结构定义

```ts
interface RenameFileItem {
  originalPath: string       // 绝对路径
  originalName: string       // 文件名
  newName?: string           // 预览的新文件名
  error?: string             // 错误提示
}

interface RenameConfig {
  mode: 'regex' | 'replace' | 'insert' | 'case' | 'sequence' | 'ext' | 'remove'
  options: Record<string, any>
}

interface RenameResult {
  success: boolean
  message?: string
  path: string
}
